{% extends 'v1_0_0/backend/base.html' %}
{% block title %}{{title}} :: {{ current_user.store.store_name }}{% endblock %}
{% block headstyles %}
<!-- Morris Chart Css-->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/morrisjs/morris.css')}}" />
<!-- Colorpicker Css -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.css')}}" />
<!-- Multi Select Css -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/multi-select/css/multi-select.css')}}">
<!-- Bootstrap Spinner Css -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-spinner/css/bootstrap-spinner.css')}}">
<!-- Bootstrap Tagsinput Css -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css')}}">
<!-- Bootstrap Select Css -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/bootstrap-select/css/bootstrap-select.css')}}" />
<!-- noUISlider Css -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/nouislider/nouislider.min.css')}}" />
<!-- Select2 -->
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/select2/select2.css')}}" />
<link rel="stylesheet" href="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/dataTables.bootstrap4.min.css')}}" />

{% endblock %}

<!-- Main Content -->
{% block content %}
<section class="content">
	<div class="block-header">
		<div class="row">
			<div class="col-lg-7 col-md-6 col-sm-12">
				<h2>Dashboard</h2>
				<ul class="breadcrumb">
					<li class="breadcrumb-item"><a href="{{ url_for('admin.dashboard') }}"><i class="zmdi zmdi-home"></i> Deogon</a></li>
					<li class="breadcrumb-item active">Dashboard</li>
				</ul>
				<button class="btn btn-primary btn-icon mobile_menu" type="button"><i class="zmdi zmdi-sort-amount-desc"></i></button>
			</div>
			<div class="col-lg-5 col-md-6 col-sm-12">
				<button class="btn btn-primary btn-icon float-right right_icon_toggle_btn" type="button"><i class="zmdi zmdi-arrow-right"></i></button>
			</div>
		</div>
	</div>
	<div class="container-fluid">
		<div class="row clearfix">
			<div class="col-lg-8 col-md-8 col-sm-8">
				<div class="card">
					<div class="header">
						<h2><strong>Product</strong> Details</h2>
						<ul class="header-dropdown">
							<li class="dropdown">
								<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> <i class="zmdi zmdi-more"></i> </a>
								<ul class="dropdown-menu dropdown-menu-right">
									<li><a href="javascript:void(0);">Action</a></li>
									<li><a href="javascript:void(0);">Another action</a></li>
									<li><a href="javascript:void(0);">Something else</a></li>
								</ul>
							</li>
							<li class="remove">
								<a role="button" class="boxs-close"><i class="zmdi zmdi-close"></i></a>
							</li>
						</ul>
					</div>
					<div class="body">
						<div class="table-responsive">
							<table class="table table-bordered table-striped table-hover dataTable js-exportable">
								<thead>
									<tr>
										<th>Serial</th>
										<th>Name</th>
										<th>Data</th>
										<th>Status</th>
										<th>Actions</th>
									</tr>
								</thead>
								<tbody>
									{% for c in counters %}
									<tr>
										<td>{{ loop.index }}</td>
										<td>{{ c.name }}</td>
										<td>{{ c.created_date.strftime('%d %b %Y') }}</td>
										<td><span class="badge badge-{{'success' if c.published else 'danger'}}">{{'Published' if c.published else 'Drafted'}}</span></td>
										<td>
											<div class="table-action-buttons">
												<a class="view button button-box button-xs button-primary" href="#"><i class="zmdi zmdi-more"></i></a>
												<a class="edit button button-box button-xs button-info" href="{{url_for('admin.counters',id=c.uuid)}}"><i class="zmdi zmdi-edit"></i> </a>
												<a class="delete button button-box button-xs button-danger" data-toggle="modal" data-target="#confirmDialogue" data-integeration='{{ c.uuid }}' href="#"><i class="zmdi zmdi-delete"></i></a>
											</div>
										</td>
									</tr>
									{% endfor %}
								</tbody>
								<tfoot>
									<tr>
										<th>Serial</th>
										<th>Name</th>
										<th>Data</th>
										<th>Status</th>
										<th>Actions</th>
									</tr>
								</tfoot>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="col-lg-4 col-md-4 col-sm-4">
				<div class="card">
					<div class="header">
						<h2><strong>Search</strong> Product</h2>
						<ul class="header-dropdown">
							<li class="dropdown">
								<a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"> <i class="zmdi zmdi-more"></i> </a>
								<ul class="dropdown-menu dropdown-menu-right">
									<li><a href="javascript:void(0);">Action</a></li>
									<li><a href="javascript:void(0);">Another action</a></li>
									<li><a href="javascript:void(0);">Something else</a></li>
								</ul>
							</li>
							<li class="remove">
								<a role="button" class="boxs-close"><i class="zmdi zmdi-close"></i></a>
							</li>
						</ul>
					</div>
					<div class="body">
						<form id="form_counter" action="{{ url_for('admin.counters')}}" method="POST">
							{{ form.hidden_tag() }}
							<div class="row clearfix">
								<div class="col-lg-12 col-md-12 col-sm-12">

									<div class="form-group">
										{{ form.value }}
									</div>
								</div>


							</div>
							<div class="row clearfix">
								<div class="col-lg-4 col-12 mb-30">
									<div class="form-group form-float">
										<div class="checkbox">
											{{ form.published }}
											{{ form.published.label }}
										</div>
									</div>
								</div>
							</div>
							<div class="col-lg-4 col-md-4 col-sm-4">
								{{ form.savebtn }}
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>
{% endblock content %}

{% block bodyScriptsA %}
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-validation/jquery.validate.js')}}"></script> <!-- Jquery Validation Plugin Css -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-steps/jquery.steps.js')}}"></script> <!-- JQuery Steps Plugin Js -->

<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js')}}"></script> <!-- Bootstrap Colorpicker Js -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-inputmask/jquery.inputmask.bundle.js')}}"></script> <!-- Input Mask Plugin Js -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/multi-select/js/jquery.multi-select.js')}}"></script> <!-- Multi Select Plugin Js -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-spinner/js/jquery.spinner.js')}}"></script> <!-- Jquery Spinner Plugin Js -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.js')}}"></script> <!-- Bootstrap Tags Input Plugin Js -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/nouislider/nouislider.js')}}"></script> <!-- noUISlider Plugin Js -->
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/bootstrap-notify/bootstrap-notify.js')}}"></script> <!-- Bootstrap Notify Plugin Js -->

<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/select2/select2.min.js')}}"></script> <!-- Select2 Js -->


<script src="{{url_for('static',filename='v1_0_0/backend/assets/bundles/datatablescripts.bundle.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/buttons/dataTables.buttons.min.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/buttons/buttons.bootstrap4.min.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/buttons/buttons.colVis.min.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/buttons/buttons.flash.min.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/buttons/buttons.html5.min.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/plugins/jquery-datatable/buttons/buttons.print.min.js')}}"></script>


{% endblock %}
{% block bodyScriptsB %}
<script src="{{url_for('static',filename='v1_0_0/backend/assets/js/pages/ui/notifications.js')}}"></script>
<script src="{{url_for('static',filename='v1_0_0/backend/assets/js/pages/forms/form-validation.js')}}"></script>
<script type="text/javascript">
    $(function () {
        $('.js-exportable').DataTable({
            dom: 'Bfrtip',
            buttons: [
                'copy', 'csv', 'excel', 'pdf', 'print'
            ]
        });
    });
	function invalidDataNotification(){
	  showNotification('alert-danger','Cannot connect to server. Please make sure you are connected to internet or contact your Administrator', 'top','right',null,null)
	}
	
	$('#form_search').submit(function (e){
	  e.preventDefault()
	  var form = $('#form_search')[0]
	  var data = new FormData(form)
	  fetch("{{ url_for('admin.add_sale', _external=True) }}",{
		credentials: 'include',
		method : 'POST',
		body: data
	  })
	  .then(resp => Promise.all([resp.ok, resp.json()]))
	  .then(([status,data]) => {
		if (status) {
			$('#category').val(data['category'])
			$('#carat').val(data['carat'])
			$('#metal').val(data['metal'])
			$('#supplier').val(data['supplier'])
			$('#operator').val(data['operator'])
			$('#ratti_method').val(data['ratti_method'])
			$('#design_no').val(data['design_no'])
			$('#size').val(data['size'])
			$('#qty').val(data['qty'])
			$('#product_code').val(data['product_code'])
			$('#weight').val(data['weight'])
			$('#waste').val(data['waste'])
			$('#ratti').val(data['ratti'])
			$('#desc').val(data['desc'])
			$('#product_id').val(data['product_id'])
			showNotification('alert-success',data['product_code'], 'top','right',null,null)
		} else {
		  showNotification('alert-danger',data['message'], 'top','right',null,null)
		}
	  })
	  .catch(e => invalidDataNotification())
	})
	
</script>
{% endblock %}
